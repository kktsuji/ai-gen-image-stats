# ==============================================================================
# CLASSIFIER CONFIGURATION (V2 FORMAT)
# ==============================================================================
# Configuration for training image classification models (ResNet, InceptionV3)
# V2 Changes: Restructured for consistency with diffusion config
# ==============================================================================

experiment: classifier
mode: train # Options: train, evaluate

# ==============================================================================
# COMPUTE CONFIGURATION
# ==============================================================================

compute:
  device: cuda # Options: cuda, cpu, auto
  seed: null # Random seed for reproducibility (null to disable)

# ==============================================================================
# MODEL CONFIGURATION
# ==============================================================================

model:
  # Architecture: Model type and structure
  architecture:
    name: resnet50 # Options: resnet50, resnet101, resnet152, inceptionv3
    num_classes: 2

  # Initialization: Pretrained weights and layer freezing
  initialization:
    pretrained: true # Use ImageNet pretrained weights
    freeze_backbone: false # Freeze all backbone layers
    trainable_layers: null # List of layer patterns to unfreeze (null = all)

  # Regularization: Model-specific regularization
  regularization:
    dropout: 0.5 # Dropout rate (InceptionV3 only)

# ==============================================================================
# DATA CONFIGURATION
# ==============================================================================

data:
  # Paths: Dataset locations
  paths:
    train: data/train # Training data directory (required)
    val: data/val # Validation data directory (null for no validation)

  # Loading: DataLoader parameters
  loading:
    batch_size: 32
    num_workers: 4
    pin_memory: true
    shuffle_train: true
    drop_last: false

  # Preprocessing: Image preprocessing before augmentation
  preprocessing:
    image_size: 256 # Resize to this size
    crop_size: 224 # Crop to this size (224 for ResNet, 299 for InceptionV3)
    normalize: imagenet # Options: imagenet, cifar10, custom, null

  # Augmentation: Data augmentation settings
  augmentation:
    horizontal_flip: true
    rotation_degrees: 0
    color_jitter:
      enabled: false
      brightness: 0.2
      contrast: 0.2
      saturation: 0.2
      hue: 0.1

# ==============================================================================
# OUTPUT CONFIGURATION
# ==============================================================================

output:
  base_dir: outputs
  subdirs:
    logs: logs
    checkpoints: checkpoints

# ==============================================================================
# TRAINING MODE CONFIGURATION
# ==============================================================================

training:
  # Core Training Parameters
  epochs: 100

  # Optimizer: Optimization algorithm and parameters
  optimizer:
    type: adam # Options: adam, adamw, sgd
    learning_rate: 0.001
    weight_decay: 0.0001
    gradient_clip_norm: null # Max gradient norm (null to disable)
    # For SGD: momentum: 0.9
    # For Adam/AdamW: betas: [0.9, 0.999]

  # Scheduler: Learning rate scheduling
  scheduler:
    type: cosine # Options: cosine, step, plateau, null
    T_max: auto # Auto = epochs, or specify number
    eta_min: 1.0e-6
    # For step: step_size: 30, gamma: 0.1
    # For plateau: mode: min, factor: 0.1, patience: 10

  # Checkpointing: Model checkpoint saving
  checkpointing:
    save_frequency: 10
    save_best_only: true
    save_optimizer: true

  # Validation: Validation during training
  validation:
    enabled: true
    frequency: 1
    metric: accuracy # Options: accuracy, loss, f1, precision, recall
    early_stopping_patience: null # Epochs to wait (null to disable)

  # Performance: Performance optimization settings
  performance:
    use_amp: false # Automatic mixed precision (CUDA only)
    use_tf32: true # Enable TF32 on Ampere+ GPUs
    cudnn_benchmark: true # cuDNN benchmark mode
    compile_model: false # Use torch.compile (PyTorch 2.0+)

  # Resume: Resume training from checkpoint
  resume:
    enabled: false
    checkpoint: null # Path to checkpoint (required if enabled)
    reset_optimizer: false
    reset_scheduler: false

# ==============================================================================
# EVALUATION MODE CONFIGURATION
# ==============================================================================

evaluation:
  checkpoint: null # Path to trained model checkpoint (required)

  data:
    test_path: data/test
    batch_size: 32

  output:
    save_predictions: true
    save_confusion_matrix: true
    save_metrics: true
