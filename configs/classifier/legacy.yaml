# ==============================================================================
# CLASSIFIER CONFIGURATION
# ==============================================================================
# Configuration for training image classification models (ResNet, InceptionV3)
# ==============================================================================

experiment: classifier

# ==============================================================================
# MODEL CONFIGURATION
# ==============================================================================
# Model architecture and initialization settings

model:
  name: resnet50 # Options: resnet50, resnet101, resnet152, inceptionv3
  pretrained: true # Use ImageNet pretrained weights
  num_classes: 2 # Number of output classes
  freeze_backbone: false # Freeze all backbone layers
  trainable_layers: null # List of layer patterns to unfreeze (InceptionV3 only, null = unfreeze all)
  dropout: 0.5 # Dropout rate (InceptionV3 only)

# ==============================================================================
# DATA CONFIGURATION
# ==============================================================================
# Dataset paths, loading, and augmentation settings

data:
  # Paths: Dataset locations
  train_path: data/train # Training data directory (required)
  val_path: data/val # Validation data directory (null for no validation)

  # Loading: DataLoader parameters
  batch_size: 32 # Batch size for training
  num_workers: 4 # Number of data loading workers
  pin_memory: true # Pin memory for faster GPU transfer
  shuffle_train: true # Shuffle training data
  drop_last: false # Drop incomplete batches

  # Image preprocessing
  image_size: 256 # Resize images to this size before cropping
  crop_size: 224 # Random crop size (224 for ResNet, 299 for InceptionV3)
  normalize: imagenet # Normalization preset: imagenet, cifar10, none, null

  # Augmentation: Data augmentation settings
  horizontal_flip: true # Random horizontal flip
  color_jitter: false # Apply color jitter augmentation
  rotation_degrees: 0 # Random rotation degrees (0 to disable)

# ==============================================================================
# TRAINING CONFIGURATION
# ==============================================================================
# Training parameters and optimization settings

training:
  # Core Training Parameters
  epochs: 100 # Number of training epochs
  learning_rate: 0.001 # Initial learning rate

  # Device and Reproducibility
  device: cuda # Options: cuda, cpu
  seed: null # Random seed for reproducibility (null to disable)

  # Optimizer: Optimization algorithm and parameters
  optimizer: adam # Options: adam, adamw, sgd
  optimizer_kwargs:
    weight_decay: 0.0001 # L2 regularization (default for Adam/AdamW)
    # For SGD: momentum: 0.9

  # Scheduler: Learning rate scheduling
  scheduler: cosine # Options: cosine, step, plateau, none, null
  scheduler_kwargs:
    T_max: 100 # For cosine: max epochs (should match training.epochs)
    eta_min: 0.000001 # For cosine: minimum learning rate
    # For step: step_size: 30, gamma: 0.1
    # For plateau: mode: min, factor: 0.1, patience: 10

  # Advanced Training Options
  mixed_precision: false # Use automatic mixed precision (AMP)
  gradient_clip: null # Max gradient norm for clipping (null to disable)
  early_stopping_patience: null # Epochs to wait before early stopping (null to disable)

# ==============================================================================
# OUTPUT CONFIGURATION
# ==============================================================================
# Checkpoint and logging settings

output:
  checkpoint_dir: outputs/checkpoints # Directory for model checkpoints
  log_dir: outputs/logs # Directory for training logs and metrics
  save_best_only: true # Save only the best model (by validation metric)
  save_frequency: 10 # Save checkpoint every N epochs (0 to save only best)

# ==============================================================================
# VALIDATION CONFIGURATION
# ==============================================================================
# Validation during training

validation:
  frequency: 1 # Run validation every N epochs
  metric: accuracy # Metric to monitor for best model: accuracy, loss
